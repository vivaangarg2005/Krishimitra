<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>KrishiMitra - Marketplace</title>
    <style>
      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background-color: #f4f9f4;
        margin: 0;
        padding: 0;
      }

      header {
        background-color: #2d572c;
        color: white;
        padding: 1.5rem;
        text-align: center;
        position: relative;

      }

      .container {
        max-width: 1000px;
        margin: 2rem auto;
        padding: 1rem;
        background-color: #fff;
        border-radius: 12px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      }

      h2 {
        color: #2d572c;
        margin-bottom: 0.5rem;
      }

      p {
        color: #333;
        margin-bottom: 1rem;
      }

      .section {
        margin-bottom: 3rem;
      }

      .section img {
        max-width: 100%;
        border-radius: 10px;
        margin: 1rem 0;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      }

      footer {
        background-color: #2d572c;
        color: white;
        text-align: center;
        padding: 1rem;
        margin-top: 3rem;
      }

      a.button {
        display: inline-block;
        padding: 0.7rem 1.2rem;
        background-color: #2d572c;
        color: white;
        border-radius: 6px;
        text-decoration: none;
        font-weight: bold;
      }

      a.button:hover {
        background-color: #3c7c3b;
      }
      /* Form styling */
      #listingForm {
        background-color: #f0f8f0;
        border: 1px solid #c2e0c2;
        border-radius: 12px;
        padding: 20px;
        margin-top: 20px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
      }

      #listingForm input,
      #listingForm textarea {
        width: 100%;
        padding: 10px;
        border: 1px solid #c2e0c2;
        border-radius: 6px;
        font-size: 1rem;
        margin-bottom: 15px;
        box-sizing: border-box;
      }

      #listingForm button {
        background-color: #2d572c;
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 6px;
        font-weight: bold;
        cursor: pointer;
      }

      #listingForm button:hover {
        background-color: #3c7c3b;
      }

      /* Listings display area */
      #listingDisplay {
        margin-top: 20px;
      }

      .listing-card {
        background-color: #ffffff;
        border: 1px solid #c2e0c2;
        border-left: 5px solid #2d572c;
        border-radius: 8px;
        padding: 15px 20px;
        margin-bottom: 15px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
        transition: transform 0.2s ease;
      }

      .listing-card:hover {
        transform: scale(1.01);
      }

      .delete-button {
        background-color: #cc2b2b;
        color: white;
        border: none;
        padding: 6px 12px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 0.9rem;
      }

      .delete-button:hover {
        background-color: #e64545;
      }
      .listing-card strong::before,
      .listing-card span::before {
        margin-right: 4px;
      }

      .delete-button {
        background-color: #2d572c;
        color: white;
        border: none;
        padding: 10px 16px;
        border-radius: 10px;
        font-size: 0.95rem;
        cursor: pointer;
        font-weight: bold;
        display: inline-flex;
        align-items: center;
        gap: 6px;
      }
      .delete-button:hover {
        background-color: #3c7c3b;
      }
      .home-button {
  position: absolute;
  top: 20px;
  right: 20px;
  color: white;
  background-color: transparent;
  padding: 8px 16px;
  border-radius: 8px;
  font-weight: bold;
  text-decoration: none;


}



    </style>
  </head>
  <body>
    <header>
      <h1>KrishiMitra Marketplace</h1>
      <p style="color: white">Where Farmers Buy, Sell, and Share Resources</p>
      <a href="krishi_1.html" class="home-button">üè† Home</a>

    </header>

    <div class="container">
      <div class="section">
        <h2>üåæ Buy & Sell Crops / Handicrafts</h2>
        <img
          src="photos/produce_fresh_page-0001.jpg"
          alt="Fresh produce in a rural market"
        />
        <p>
          Post listings to sell your farm produce or handmade items. Explore
          what others are offering and get fair deals directly from other
          farmers and artisans.
        </p>
        <a href="#" class="button">Go to Listings</a>
        <!-- Listing Form (hidden initially) -->
        <div
          id="listingForm"
          style="
            display: none;
            margin-top: 20px;
            border-top: 1px solid #ccc;
            padding-top: 20px;
          "
        >
          <h3 style="color: #2d572c">Create Your Listing</h3>
          <form onsubmit="submitListing(event)">
            <label>Crop/Product Name:</label>
            <input
              type="text"
              id="cropName"
              required
              style="width: 100%; padding: 8px"
            />

            <label>Minimum Quantity (e.g. 50 kg, 20 pieces):</label>
            <input
              type="text"
              id="quantity"
              required
              style="width: 100%; padding: 8px"
            />

            <label>Price You're Offering (‚Çπ per unit):</label>
            <input
              type="number"
              id="price"
              required
              style="width: 100%; padding: 8px"
            />

            <label>Optional Description / Location:</label>
            <textarea
              id="description"
              rows="3"
              style="width: 100%; padding: 8px"
            ></textarea>

            <button type="submit" class="button">Post Listing</button>
          </form>
          <h3 style="color: #2d572c">üß∫ My Listings</h3>
          <div id="listingDisplay" style="margin-top: 10px"></div>
        </div>
      </div>

      <div class="section">
        <h2>üöú Equipment Rental Services</h2>
        <img
          src="photos/rentals_page-0001.jpg"
          alt="Farm equipment available for rent"
        />
        <p>
          Need a tractor, thresher, or irrigation equipment? Rent shared farm
          equipment from your local area at affordable rates.
        </p>
        <a href="book_now.html" class="button">Explore Rentals</a>
      </div>

      <div class="section">
        <h2>ü§ù Farmers‚Äô Connect</h2>
        <img
          src="photos/rural talk_page-0001.jpg"
          alt="Farmers talking and collaborating"
        />
        <p>
          Find other farmers near you who are looking to collaborate or trade.
          Form cooperatives or just share tips and stories.
        </p>
        <a href="join_the_community.html" class="button">Join the Community</a>
      </div>
    </div>

    <footer>
      <p style="color: white">
        &copy; 2025 KrishiMitra. Empowering Rural India.
      </p>
    </footer>
    <!-- Updated AI Chatbot Code -->
    <!-- Remove or replace previous chatbot anchor -->
    <a id="bot-main" href="https://cdn.botpress.cloud/webchat/v2.3/shareable.html?configUrl=https://files.bpcontent.cloud/2025/03/27/06/20250327061520-WXWH4E6R.json" target="_blank" style="position: fixed; bottom: 20px; right: 20px; background: #2d572c; border-radius: 50%; width: 60px; height: 60px; display: flex; align-items: center; justify-content: center; text-decoration: none; box-shadow: 0 2px 6px rgba(0,0,0,0.3);">
      <img src="https://img.icons8.com/ios-filled/50/ffffff/chat.png" alt="Chatbot Icon" style="width:30px; height:30px;">
    </a>
    <div id="bot-container" style="position: fixed; bottom: 20px; right: 20px; width: 300px; height: 400px; background: white; border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); overflow: hidden; display: none;">
      <iframe src="https://cdn.botpress.cloud/webchat/v2.3/shareable.html?configUrl=https://files.bpcontent.cloud/2025/03/27/06/20250327061520-WXWH4E6R.json" style="width: 100%; height: 100%; border: none;"></iframe>
    </div>
    <a id="bot-toggle" onclick="toggleBot()" style="position: fixed; bottom: 20px; right: 20px; background: #2d572c; border-radius: 50%; width: 60px; height: 60px; display: flex; align-items: center; justify-content: center; text-decoration: none; box-shadow: 0 2px 6px rgba(0,0,0,0.3); cursor: pointer;">
      <img src="https://img.icons8.com/ios-filled/50/ffffff/chat.png" alt="Chatbot Icon" style="width: 30px; height: 30px;">
    </a>
    <script>
      function toggleBot() {
        const botContainer = document.getElementById('bot-container');
        if (botContainer.style.display === 'none' || botContainer.style.display === '') {
          botContainer.style.display = 'block';
        } else {
          botContainer.style.display = 'none';
        }
      }

      // Show the listing form
      document
        .querySelector(".section a.button")
        .addEventListener("click", function (e) {
          e.preventDefault();
          document.getElementById("listingForm").style.display = "block";
          window.scrollTo({
            top: document.getElementById("listingForm").offsetTop - 100,
            behavior: "smooth",
          });
        });

      // Function to handle form submission
      function submitListing(event) {
        event.preventDefault();

        const name = document.getElementById("cropName").value;
        const quantity = document.getElementById("quantity").value;
        const price = document.getElementById("price").value;
        const description = document.getElementById("description").value;

        const newListing = {
          name,
          quantity,
          price,
          description,
        };

        // Save to localStorage
        const listings = JSON.parse(
          localStorage.getItem("krishiListings") || "[]"
        );
        listings.push(newListing);
        localStorage.setItem("krishiListings", JSON.stringify(listings));

        // Reset and hide form
        event.target.reset();
        document.getElementById("listingForm").style.display = "none";

        // Refresh the listing display
        renderListings();
      }

      // Function to render all listings
      function renderListings() {
        const displayDiv = document.getElementById("listingDisplay");
        const listings = JSON.parse(
          localStorage.getItem("krishiListings") || "[]"
        );

        if (listings.length === 0) {
          displayDiv.innerHTML =
            "<p>No listings yet. Be the first to post!</p>";
          return;
        }

        displayDiv.innerHTML = listings
          .map(
            (listing, index) => `
          <div class="listing-card">
            <strong>üìå ${listing.name}</strong><br>
            üì¶ <strong>Minimum Quantity:</strong> ${listing.quantity}<br>
            üí∞ <strong>Price:</strong> ‚Çπ${listing.price} per unit<br>
            üìù <strong>Details:</strong> ${
              listing.description || "No description"
            }<br><br>
            <button onclick="deleteListing(${index})" class="delete-button">üóëÔ∏è Delete</button>
          </div>
        `
          )
          .join("");
      }

      function deleteListing(index) {
        const confirmDelete = confirm(
          "Are you sure you want to delete this listing?"
        );
        if (!confirmDelete) return;

        const listings = JSON.parse(
          localStorage.getItem("krishiListings") || "[]"
        );
        listings.splice(index, 1);
        localStorage.setItem("krishiListings", JSON.stringify(listings));
        renderListings();
      }

        const API_URL = "http://localhost:5000/api/listings";
        window.onload = renderListings;
      </script>

  </body>
</html>
